
// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id        String   @id @default(cuid())
  nome      String
  email     String   @unique
  senha     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  gastos      Gasto[]
  contasFixas ContaFixa[]

  @@map("usuarios")
}


model Gasto {
  id              String          @id @default(cuid())
  descricao       String
  valor           Float
  dataVencimento  DateTime
  tipo            TipoGasto
  parcelas        Int             @default(1)
  parcelaAtual    Int?
  data            DateTime        @default(now())
  status          StatusPagamento @default(A_PAGAR)
  usuarioId       String
  
  usuario         Usuario         @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  parcelasGasto   Parcela[]
  
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@map("gastos")
}

model ContaFixa {
  id              String          @id @default(cuid())
  nome            String
  valor           Float
  status          StatusPagamento @default(A_PAGAR)
  dataVencimento  DateTime
  usuarioId       String
  
  usuario         Usuario         @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@map("contas_fixas")
}

model Parcela {
  id              String          @id @default(cuid())
  descricao       String
  valor           Float
  dataVencimento  DateTime
  numeroParcela   Int
  totalParcelas   Int
  status          StatusPagamento @default(A_PAGAR)
  idGastoPrincipal String
  
  gastoPrincipal  Gasto           @relation(fields: [idGastoPrincipal], references: [id], onDelete: Cascade)
  
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@map("parcelas")
}

enum TipoGasto {
  CARTAO_CREDITO
  DEBITO
  PIX
  BOLETO

  @@map("tipo_gasto")
}

enum StatusPagamento {
  PAGO
  ATRASADO
  A_PAGAR

  @@map("status_pagamento")
}
